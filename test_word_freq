#!/bin/bash
# SPDX-FileCopyrightText: 2024 Jyunta Suzuki 　　　　　
# SPDX-License-Identifier: BSD-3-Clause

ng () {
    echo "${1}行目が違うよ"
    res=1
}

# 初期化
res=0

# テストケース
out=$(echo "This is a test. This is only a test." | ./word_freq)
echo "$out" | grep -q "this: 2" && echo "$out" | grep -q "is: 2" && \
echo "$out" | grep -q "a: 2" && echo "$out" | grep -q "test: 2" && \
echo "$out" | grep -q "only: 1" || ng "$LINENO"

out=$(echo "Hello world! Hello everyone." | ./word_freq)
echo "$out" | grep -q "hello: 2" && echo "$out" | grep -q "world: 1" && \
echo "$out" | grep -q "everyone: 1" || ng "$LINENO"

out=$(echo "Python is fun. Python is powerful." | ./word_freq)
echo "$out" | grep -q "python: 2" && echo "$out" | grep -q "is: 2" && \
echo "$out" | grep -q "fun: 1" && echo "$out" | grep -q "powerful: 1" || ng "$LINENO"

out=$(echo "12345 @@@ ###" | ./word_freq)
[ -z "$out" ] || ng "$LINENO"  # 出力が空であることを確認

out=$(echo "apple banana apple cherry cherry cherry" | ./word_freq)
echo "$out" | grep -q "apple: 2" && echo "$out" | grep -q "banana: 1" && \
echo "$out" | grep -q "cherry: 3" || ng "$LINENO"

# 結果
if [ "$res" -eq 0 ]; then
    echo "All tests passed!"
else
    echo "テストに失敗しました"
fi

exit $res

